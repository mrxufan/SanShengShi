<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>拖拽购物车</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="" rel="stylesheet">
<style type="text/css">
ul,p{margin: 0;padding: 0}
ul{overflow: hidden;}
li{list-style: none;width: 200px;border: 1px solid #333;margin: 10px;float: left;}
li img{width: 100%;}
p{border-bottom: 1px dashed #333;height: 20px;}
#div1{width: 600px;height: 400px;border: 1px solid #333;}
#div1 .box1{width: 200px;float: left;}
#div1 .box2{width: 200px;float: left;}
#div1 .box3{width: 200px;float: left;}
#allMoney{float: right;}
</style>
</head>
<body>
<ul id="ul">
	<li draggable="true">
		<img src="images/shop_car/img1.jpg">
		<p>javascript语言精粹</p>
		<p>40￥</p>
	</li>
	<li draggable="true">
		<img src="images/shop_car/img2.jpg">
		<p>javascript权威指南</p>
		<p>120￥</p>
	</li>
	<li draggable="true">
		<img src="images/shop_car/img3.jpg">
		<p>精通javascript</p>
		<p>35￥</p>
	</li>
	<li draggable="true">
		<img src="images/shop_car/img4.jpg">
		<p>DOM编程艺术</p>
		<p>45￥</p>
	</li>
</ul>
<div id="div1">
	<!-- <p>
		<span class="box1">1</span>
		<span class="box2">DOM编程艺术</span>
		<span class="box3">45￥</span>
	</p>
	<p>
		<span class="box1">1</span>
		<span class="box2">DOM编程艺术</span>
		<span class="box3">45￥</span>
	</p> -->
	<!-- <div id="allMoney">90￥</div> -->
</div>
<script type="text/javascript">
var oli=document.getElementById('ul').getElementsByTagName('li');
var oDiv=document.getElementById('div1');
var obj={};
var iNum=0;
var allMoney=null;
for (var i = 0; i < oli.length; i++) {
	oli[i].ondragstart=function (ev) {
		var aP=this.getElementsByTagName('p');
		ev.dataTransfer.setData('title',aP[0].innerHTML);
		ev.dataTransfer.setData('money',aP[1].innerHTML);
		ev.dataTransfer.setDragImage(this,0,0);
	};
}
oDiv.ondragover=function (ev) {
	ev.preventDefault();
};
oDiv.ondrop=function (ev) {
	ev.preventDefault();
	var sTitle=ev.dataTransfer.getData('title');
	var sMoney=ev.dataTransfer.getData('money');

	if (!obj[sTitle]) {
		var oP=document.createElement('p');
		var oSpan=document.createElement('span');
		oSpan.className='box1';
		oSpan.innerHTML=1;
		oP.appendChild(oSpan);

		var oSpan=document.createElement('span');
		oSpan.className='box2';
		oSpan.innerHTML=sTitle;
		oP.appendChild(oSpan);

		var oSpan=document.createElement('span');
		oSpan.className='box3';
		oSpan.innerHTML=sMoney;
		oP.appendChild(oSpan);

		oDiv.appendChild(oP);

		obj[sTitle]=1;
	} else {
		var box1=document.getElementsByClassName('box1');
		var box2=document.getElementsByClassName('box2');
		for (var i = 0; i < box2.length; i++) {
			if (box2[i].innerHTML==sTitle) {
				box1[i].innerHTML=parseInt(box1[i].innerHTML)+1;
			}
		}
	}

	if (!allMoney) {
		allMoney=document.createElement('div');
		allMoney.id='allMoney';
		
	}
	iNum+=parseInt(sMoney);
	allMoney.innerHTML=iNum+'￥';
	oDiv.appendChild(allMoney);


};

</script>
</body>
</html>