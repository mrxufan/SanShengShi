<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <meta content="telephone=no" name="format-detection" />
    <title>CSS3 水平抛物线动画</title>
    <script>
  
      (function(){
      	function change(){
      		var width=document.documentElement.clientWidth; //窗口宽度
      		var html=document.documentElement; 
      		html.style.fontSize=width/375*100+'px';
      	}
      	change();
      	window.addEventListener('resize',change);
      }());


    </script>
    <style type="text/css">
      *{
        padding: 0;
        margin: 0;
      }
      .main{
 
      }
      .product{
 
      }
      .product ul li{
        font-size: 0.2rem;
        position: relative;
        height: .5rem;
      }
      .product ul li:after{
        content: '';
        position: absolute;
        left: 0;
        bottom: 0;
        width: 100%;
        height: 1px;
        border-bottom: 1px solid #eeeeee;
      }
      .product ul li .buy{
        position: absolute;
        left: .1rem;
        font-size: 0.16rem;
        border: 1px solid #ed2e40;
        color: #ed2e40;
        top: 50%;
        transform: translateY(-50%);
        width: .2rem;height: .2rem;
        text-align: center;line-height: .2rem;
      }
      .buyCar{
        position: fixed;
        bottom: 0.2rem;
        right: 0.2rem;
        font-size: 0.12rem;
        width: 0.5rem;
        text-align: center;
        height: 0.5rem;
        line-height: 0.5rem;
        border-radius: 50%;
        background-color: #ed2e40;
        color: #fff;
        z-index: 3;
      }
      #ball {
        width:15px;
        height:15px;
        background: #f40;
        border-radius: 50%;
        position: fixed;
        z-index: 2;
        bottom: 0.6rem;
        left: 0.6rem;
      }
      .inp{
      	width: .4rem;position: absolute;left: .4rem;top: 50%;transform: translateY(-50%);border: none;border: 1px solid #333;height: .2rem;text-align: center;
      }

      .del{
      	position: absolute;
        left: .9rem;
        font-size: 0.16rem;
        border: 1px solid #ed2e40;
        color: #ed2e40;
        top: 50%;
        transform: translateY(-50%);
        width: .2rem;height: .2rem;
        text-align: center;line-height: .2rem;
      }

    </style>
  </head>
  <body>

  <div class="main">
    <div class="product">
      <ul id="ul">
        <li><div class="con"></div><span class="buy" onclick="buy()">购买</span></li>
      </ul>
    </div>
    <div class="buyCar">购物车</div>
    <!--<div id="ball"></div>-->
  </div>
  <script>
      //生成HTML标签
      document.getElementById('ul').innerHTML='';
      for(var i=0;i<30;i++){
          var newLi = document.createElement("li");
          newLi.innerHTML = '<span class="buy" onclick="buy(this)">+</span><input readonly class="inp" type="number" value="0"><span class="del" onclick="del(this)">-</span>';
          document.getElementById('ul').appendChild(newLi);
      }
      //生成水平抛物线动画 var ball=parabolic();   ball(e); //传入点击标签
      function parabolic() {
          return function (e) {
              //生成动画标签
              var ball = document.createElement("div");
              ball.id = 'ball';
              document.body.appendChild(ball);
 
              var rect = e.getBoundingClientRect(); //getBoundingClientRect获得页面中某个元素的左，上，右和下分别相对浏览器视窗的位置。
              ball.style.top = (rect.top+rect.height/2)+'px';
              ball.style.left = rect.left+'px';
              ball.style.transition = 'left 0s, top 0s';
              //获取购物车标签
              var buyCar=document.getElementsByClassName('buyCar')[0].getBoundingClientRect();
              setTimeout(()=>{
                  ball.style.top = window.innerHeight-(window.innerHeight-buyCar.top-buyCar.height/2)+'px';
                  ball.style.left = (buyCar.left+buyCar.height/2)+'px';
                  ball.style.transition = 'left 1s linear, top 1s ease-in';
              }, 20);
              //动画结束后自动删除
              setTimeout(function () {
                  document.body.removeChild(ball);
              },1050);
          };
      }
      

      // 点击添加获取数量，并开始动画
      function buy(e) {
      	e.nextElementSibling.value++;
      	console.log(e.nextElementSibling.value);

          var ball=parabolic();
          ball(e);
      }


      // 点击减去
      function del(e){
      	if (e.previousElementSibling.value<=0) {
      		return;
      	}
      	e.previousElementSibling.value--;
      	console.log(e.previousElementSibling.value);
      }




   




  </script>
  </body>
</html>
